#字符编码

常见文件编码：GB2312、GBK、GB18030、UTF-8、BIG5等。
**GB2312**
简体中文编码
**BIG5**
繁体中文编码
**GBK**
非国家标准的GB2312+BIG5
**GB18030**
GB国家新标准，向下兼容
**UTF-8**
万国码，国家标准编码

### 概念
字符集、字符编码

#### 字符集
字符的集合，不同字符集最直观的区别就是字符数量不同，常见字符集有ascii字符集、GB2312字符集、BIG5字符集、GB18030字符集、Unicode字符集。

#### 字符编码
字符编码决定了字符集到实际二进制字符的映射方式，每一种字符编码都有自己的设计规则。
提到UTF-8，如果未明确表明，一般语意上是指字符编码。
字符集与字符编码是一对多的关系，如Unicode字符集下有UTF-8、UTF-16等字符编码。

### BOM（Byte Order Mark）
文件保存时可选字符编码，如ANSI（扩展的Ascii码）、GB、UTF-8。

#### windows如何判断文件使用何种编码方式。
在头部增加三个字节（0xef，0xbb，0xbf）表示UTF-8；两个字节（0xff，0xfe或0xfe，0xff）表示UTF-16；没有这表示GB**。

## 重新理解
### Ascii码
计算机内信息由二进制`1`和`0`构成，8个二进制位就可以构成256种状态为一个字节（000000000-11111111）。美国制定了一套规则用于规定二进制与英文字符的对应关系，`A`是65（二进制位`1000001`）。

### Unicode
容纳了几乎所有符号的编码

### Unicode的问题
对于英文字符一个字节即可表示一个字符，但对于中文（x万个字符）等其他字符，一个字节远远不够。那么就需要使用几个字节来表示一个字符。如果对于英文字符也采用几个字节来表示，那么前面两、三个字节都是补0，浪费内存。

### UTF-8
Unicode的实现方式之一。
> UTF-8 的编码规则很简单，只有二条：
>    1）对于单字节的符号，字节的第一位设为0，后面7位为这个符号的 Unicode 码。因此对于英语字母，UTF-8 编码和 ASCII 码是相同的。
    2）对于n字节的符号（n > 1），第一个字节的前n位都设为1，第n + 1位设为0，后面字节的前两位一律设为10。剩下的没有提及的二进制位，全部为这个符号的 Unicode 码。

>    下表总结了编码规则，字母x表示可用编码的位。

| Unicode符号范围 (十六进制)  |        UTF-8编码方式（二进制）           |
| ------------------------ | ----------------------------------- |
|0000 0000-0000 007F        | 0xxxxxxx                              |
|0000 0080-0000 07FF        | 110xxxxx 10xxxxxx                     |
|0000 0800-0000 FFFF        | 1110xxxx 10xxxxxx 10xxxxxx            |
|0001 0000-0010 FFFF        | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx   |

>    跟据上表，解读 UTF-8 编码非常简单。如果一个字节的第一位是0，则这个字节单独就是一个字符；如果第一位是1，则连续有多少个1，就表示当前字符占用多少个字节。

>    下面，还是以汉字严为例，演示如何实现 UTF-8 编码。

>    "严"的 Unicode 是4E25（100111000100101），根据上表，可以发现4E25处在第三行的范围内（0000 0800 - 0000 FFFF），因此严的 UTF-8 编码需要三个字节，即格式是1110xxxx 10xxxxxx 10xxxxxx。然后，从严的最后一个二进制位开始，依次从后向前填入格式中的x，多出的位补0。这样就得到了，严的 UTF-8 编码是11100100 10111000 10100101，转换成十六进制就是E4B8A5。

### Little endian和Big endian
>上一节已经提到，UCS-2 格式可以存储 Unicode 码（码点不超过0xFFFF）。以汉字严为例，Unicode 码是4E25，需要用两个字节存储，一个字节是4E，另一个字节是25。存储的时候，4E在前，25在后，这就是 Big endian 方式；25在前，4E在后，这是 Little endian 方式。

>    这两个古怪的名称来自英国作家斯威夫特的《格列佛游记》。在该书中，小人国里爆发了内战，战争起因是人们争论，吃鸡蛋时究竟是从大头(Big-endian)敲开还是从小头(Little-endian)敲开。为了这件事情，前后爆发了六次战争，一个皇帝送了命，另一个皇帝丢了王位。

>    第一个字节在前，就是"大头方式"（Big endian），第二个字节在前就是"小头方式"（Little endian）。

>    那么很自然的，就会出现一个问题：计算机怎么知道某一个文件到底采用哪一种方式编码？

>    Unicode 规范定义，每一个文件的最前面分别加入一个表示编码顺序的字符，这个字符的名字叫做"零宽度非换行空格"（zero width no-break space），用FEFF表示。这正好是两个字节，而且FF比FE大1。

>    如果一个文本文件的头两个字节是FE FF，就表示该文件采用大头方式；如果头两个字节是FF FE，就表示该文件采用小头方式。